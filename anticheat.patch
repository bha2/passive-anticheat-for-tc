diff -r 62b7591c2cae src/server/game/Chat/Chat.h
--- a/src/server/game/Chat/Chat.h	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/game/Chat/Chat.h	Mon Nov 22 23:05:47 2010 -0300
@@ -340,6 +340,12 @@
 
         bool HandleTempGameObjectCommand(const char* args);
 
+        // ANTICHEAT
+        bool HandleAntiCheatGlobalCommand(const char* args); // top3 : Amount || Average || (Amount && Average)
+        bool HandleAntiCheatPlayerCommand(const char* args); // returns especific player's average and amount
+        bool HandleAntiCheatDeleteCommand(const char* args); // if no player name as parameter, deletes all logs else deletes specific player's log
+        bool HandleAntiCheatHandleCommand(const char* args); // turn it on, turn it off 
+
         //! Development Commands
 
         /*bool HandleQuestAdd(const char * args);
diff -r 62b7591c2cae src/server/game/Chat/Commands/Level0.cpp
--- a/src/server/game/Chat/Commands/Level0.cpp	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/game/Chat/Commands/Level0.cpp	Mon Nov 22 23:05:47 2010 -0300
@@ -56,6 +56,14 @@
 {
     Player *chr = m_session->GetPlayer();
 
+    // anticheat code
+    if (chr->GetAreaId() == 876 && !chr->isGameMaster())
+    {
+        SendSysMessage("You can't do that, you are jailed!");
+        SetSentErrorMessage(true);
+        return false;
+    }
+
     if (chr->isInFlight())
     {
         SendSysMessage(LANG_YOU_IN_FLIGHT);
diff -r 62b7591c2cae src/server/game/Entities/Player/Player.cpp
--- a/src/server/game/Entities/Player/Player.cpp	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/game/Entities/Player/Player.cpp	Mon Nov 22 23:05:47 2010 -0300
@@ -617,6 +617,10 @@
 
 Player::~Player ()
 {
+    // anticheat
+    if (sWorld.getBoolConfig(CONFIG_ANTICHEAT_ENABLE))
+        CleanTempCheatReports();
+
     // it must be unloaded already in PlayerLogout and accessed only for loggined player
     //m_social = NULL;
 
@@ -652,6 +656,247 @@
     sWorld.DecreasePlayerCount();
 }
 
+bool Player::HasFirstReport()
+{
+    PreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_GET_CHEAT_FIRST_REPORT);
+    stmt->setUInt64(0,GetGUIDLow());
+
+    PreparedQueryResult result = CharacterDatabase.Query(stmt);
+
+    if (result)
+        return true;
+    else 
+        return false;
+}
+
+void Player::CleanTempCheatReports()
+{
+    for (uint8 uiI = 0; uiI < 2; uiI++)
+    {
+        PreparedStatement* stmt;
+
+        if (uiI == 0)
+            stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_DEL_CHEAT_FIRST_REPORT);
+        else 
+            stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_DEL_CHEATERS_TEMP); 
+
+        stmt->setUInt64(0,GetGUIDLow());
+        CharacterDatabase.Execute(stmt);
+    }
+}
+
+void Player::WalkOnWaterHackDetection(MovementInfo& pOldPacket, MovementInfo& pNewPacket)
+{
+    if (HasAuraType(SPELL_AURA_FEATHER_FALL) || HasAuraType(SPELL_AURA_SAFE_FALL) || HasAuraType(SPELL_AURA_WATER_WALK))
+        return;
+
+    // 1066 -> Aquatic Form
+    if (HasAura(1066))
+        return;
+
+    if (IsUnderWater())
+        return;
+
+    float water_level = GetBaseMap()->GetWaterLevel(GetPositionX(),GetPositionY());
+    float water_level_diff = fabs(water_level - GetPositionZ());
+
+    if (water_level_diff > 0.15f)
+        return;
+
+    // we like check heartbeat movements
+    if (pNewPacket.GetMovementFlags() != GetUnitMovementFlags() || 
+        pNewPacket.GetMovementFlags() != pOldPacket.GetMovementFlags())
+        return;
+
+    // if we have movementflag_waterwalking and not an aura for it, we are cheating.
+    if (HasUnitMovementFlag(MOVEMENTFLAG_WATERWALKING) && !CanFlyAnticheat(pNewPacket) && !IsFlying())
+    {
+        sLog.outError("Cheater! WaterWalking guid %u name %s Latency %u",GetGUIDLow(),GetName(), GetSession()->GetLatency());
+        ElaborateCheatReport(this,3);
+    }
+}
+
+void Player::FlyHackDetection(MovementInfo& pOldPacket, MovementInfo& pNewPacket)
+{
+    if (HasAuraType(SPELL_AURA_FEATHER_FALL) || HasAuraType(SPELL_AURA_SAFE_FALL))
+        return;
+
+    if (IsFalling())
+        return;
+
+    // we like check heartbeat movements
+    if (pNewPacket.GetMovementFlags() != GetUnitMovementFlags() || 
+        pNewPacket.GetMovementFlags() != pOldPacket.GetMovementFlags())
+        return;
+
+    if (IsFlying() && !CanFlyAnticheat(pNewPacket))
+    {
+        // if the player has flying movement flags but no auras that add them; player is C H E A T I N G !!
+        sLog.outError("Cheater! Fly guid %u name %s Latency %u",GetGUIDLow(),GetName(),GetSession()->GetLatency());
+        ElaborateCheatReport(this,2);
+    }
+}
+
+void Player::SpeedHackDetection(MovementInfo& pOldPacket, MovementInfo& pNewPacket, uint32 uiOpcode, float fLastSpeedRate)
+{
+    // strange packet
+    if (uiOpcode == MSG_MOVE_SET_FACING)
+        return;
+
+    // we like check heartbeat movements
+    if (pNewPacket.GetMovementFlags() != GetUnitMovementFlags() || 
+        pNewPacket.GetMovementFlags() != pOldPacket.GetMovementFlags())
+        return;
+
+    // just to prevent false reports
+    if (GetVehicle())
+        return;
+    
+    // the best way is checking the ip of the target, if it is the same this check should return.
+    if (GetMotionMaster()->GetCurrentMovementGeneratorType() == TARGETED_MOTION_TYPE)
+        return;
+
+    // it will make false reports
+    if (IsFalling() && CanFlyAnticheat(pNewPacket))
+        return;
+
+    // the same reason for IsFalling, just in case...
+    if (HasAuraType(SPELL_AURA_FEATHER_FALL) || HasAuraType(SPELL_AURA_SAFE_FALL))
+        return;
+
+    uint8 uiMoveType = 0;
+
+    if (IsFlying())
+        uiMoveType = MOVE_FLIGHT;
+    else if (IsUnderWater())
+        uiMoveType = MOVE_SWIM;
+    else 
+        uiMoveType = MOVE_RUN;
+
+    // core-side speed-rate: Speed / 7
+    float fSpeedRate = GetSpeedRate(UnitMoveType(uiMoveType));
+
+    // in my opinion this var must be constant in each check to avoid false reports
+    if (fLastSpeedRate != fSpeedRate)
+        return;
+
+    // Calculate Distance2D
+    float fDistance2d = pNewPacket.pos.GetExactDist2dSq(GetPositionX(),GetPositionY());
+
+    // time between packets
+    uint32 uiDiffTime =  getMSTimeDiff(pOldPacket.time, pNewPacket.time);
+    
+    // fClientRate = it is the player's rate calculated using the distance done by the player
+    float fClientRate = (fDistance2d * 1000 / uiDiffTime) /  GetSpeed(UnitMoveType(uiMoveType));
+
+    // fServerRate = it is the player's rate using the distance per second (core information)
+    float fServerRate = GetSpeed(UnitMoveType(uiMoveType)) * uiDiffTime / 1000 + sWorld.getFloatConfig(CONFIG_ANTICHEAT_MAX_DISTANCE_DIFF_ALLOWED);
+
+    if (fDistance2d > 0.0f && fClientRate >  fServerRate)
+    {
+        /*sLog.outError("-----------------");
+        sLog.outError("(CORE-SIDE) SpeedRate %f", fSpeedRate);
+        sLog.outError("(CORE-SIDE) Speed %f", GetSpeed(UnitMoveType(uiMoveType)));
+        sLog.outError("(PLAYER-SIDE) PlayerRate  %f", fClientRate);
+        sLog.outError("(PLAYER-SIDE) DiffTime  %u", uiDiffTime);
+        sLog.outError("fServerRate: %f",fServerRate);
+        sLog.outError("(PLAYER-SIDE) Distancia %f", fDistance2d);
+        sLog.outError("(PLAYER-SIDE) GetSpeed %f", GetSpeed(UnitMoveType(uiMoveType)));
+        sLog.outError("NEW POS: X %f Y %f",pNewPacket.pos.GetPositionX(), pNewPacket.pos.GetPositionY());
+        sLog.outError("OLD POS: X %f Y %f",GetPositionX(),GetPositionY());
+        sLog.outError("Mejor distancia: %f",pNewPacket.pos.GetExactDist2dSq(GetPositionX(),GetPositionY()));
+        sLog.outError("time: %u", pNewPacket.time);
+        sLog.outError("time1: %u", pNewPacket.t_time);
+        sLog.outError("time2: %u", pNewPacket.t_time2);
+        sLog.outError("OPCODE: %u",uiOpcode);*/
+
+        sLog.outError("CHEATER! SpeedHack guid %u name %s Latency %u",GetGUIDLow(),GetName(), GetSession()->GetLatency());
+        ElaborateCheatReport(this,1);
+    }
+}
+
+void Player::ElaborateCheatReport(Player* pPlayer, uint8 uiCheatType)
+{
+    if (!pPlayer)
+        return;
+
+    // cheatType 1 == SpeedHack
+    // cheatType 2 == FlyHack
+    // cheatType 3 == WalkOnWaterHack
+
+    std::string strReportType;
+
+    switch(uiCheatType)
+    {
+    case 1:
+        strReportType = "Speed-Hack";
+        break;
+    case 2:
+        strReportType = "Fly-Hack"; 
+        break;
+    case 3:
+        strReportType = "WalkOnWater-Hack";
+        break;
+    default:
+        strReportType = "";
+        break;
+    }
+
+    if (!HasFirstReport())
+    {
+        PreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_SET_CHEAT_FIRST_REPORT);
+        stmt->setUInt64(0,GetGUIDLow());
+        stmt->setString(1,GetName());
+        stmt->setUInt64(2, uint64(time(NULL)));
+        CharacterDatabase.Execute(stmt);
+    }
+    
+    for (uint8 uiI = 0; uiI < 2; uiI++)
+    {
+        PreparedStatement* stmt;
+
+        if (uiI == 0)
+            stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_SET_CHEATERS);
+        else 
+            stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_SET_CHEATERS_TEMP);
+
+        stmt->setUInt64(0,GetGUIDLow());
+        stmt->setString(1,GetName());
+        stmt->setUInt32(2,GetMapId());
+        stmt->setFloat(3,GetPositionX());
+        stmt->setFloat(4,GetPositionY());
+        stmt->setFloat(5,GetPositionZ());
+        stmt->setString(6,strReportType);
+        stmt->setUInt64(7, uint64(time(NULL)));
+        CharacterDatabase.Execute(stmt);
+    }
+
+    PreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_GET_CHEATERS_BY_GUID);
+    stmt->setUInt32(0,this->GetGUIDLow());
+    PreparedQueryResult result = CharacterDatabase.Query(stmt);
+    uint32 warnings = 0;
+    if (result)
+    {
+        do
+        {
+            Field* fields=result->Fetch();
+            warnings = fields[0].GetUInt32();
+        }
+        while (result->NextRow());
+    }
+
+    if (warnings > sWorld.getIntConfig(CONFIG_ANTICHEAT_REPORTS_FOR_GM_WARNING) && 
+        sWorld.getIntConfig(CONFIG_ANTICHEAT_REPORTS_FOR_GM_WARNING) >= 0)
+    {
+        // display warning at the center of the screen, hacky way.
+        std::string str = "";
+        str = "|cFFFFFC00[AC]|cFF00FFFF[|cFF60FF00" + std::string(pPlayer->GetName()) + "|cFF00FFFF] Possible cheater!";
+        WorldPacket data(SMSG_NOTIFICATION, (str.size()+1));
+        data << str;
+        sWorld.SendGlobalGMMessage(&data);
+    }
+}
+
 void Player::CleanupsBeforeDelete(bool finalCleanup)
 {
     TradeCancel(false);
@@ -20005,6 +20250,29 @@
     }
 }
 
+bool Player::CanFlyAnticheat(MovementInfo& pMovementInfo)
+{
+    if (IsUnderWater())
+        return true;
+
+    if (HasAuraType(SPELL_AURA_FLY) || 
+        HasAuraType(SPELL_AURA_WATER_WALK) || 
+        HasAuraType(SPELL_AURA_MOD_INCREASE_MOUNTED_FLIGHT_SPEED) || 
+        HasAuraType(SPELL_AURA_MOD_INCREASE_FLIGHT_SPEED) ||
+        HasAuraType(SPELL_AURA_FEATHER_FALL) ||
+        HasAuraType(SPELL_AURA_SAFE_FALL))
+        return true;
+
+    if (Creature* pCreature = GetVehicleCreatureBase())
+        if (pCreature->GetCreatureInfo()->InhabitType & INHABIT_AIR)
+            return true;
+
+    if (HasUnitMovementFlag(MOVEMENTFLAG_JUMPING) ||  pMovementInfo.HasMovementFlag(MOVEMENTFLAG_JUMPING) || GetMap()->GetGameObject(pMovementInfo.t_guid))
+        return true;
+
+    return false;
+}
+
 void Player::UpdatePvPState(bool onlyFFA)
 {
     // TODO: should we always synchronize UNIT_FIELD_BYTES_2, 1 of controller and controlled?
diff -r 62b7591c2cae src/server/game/Entities/Player/Player.h
--- a/src/server/game/Entities/Player/Player.h	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/game/Entities/Player/Player.h	Mon Nov 22 23:05:47 2010 -0300
@@ -2380,6 +2380,22 @@
         float GetAverageItemLevel();
         bool isDebugAreaTriggers;
 
+        /*********************************************************/
+        /***                 ANTICHEAT SYSTEM                  ***/
+        /*********************************************************/
+        float GetLastSpeedRate() { return fLastSpeedRate; }
+        uint32 GetLastOpcode() { return uiLastOpcode; }
+        MovementInfo& GetLastPacket() { return lastMovementInfo; }
+        void SaveLastPacket(MovementInfo& pMovementInfo) { lastMovementInfo = pMovementInfo; }
+        void SetLastSpeedRate(float fSpeedRateRate) { fLastSpeedRate = fSpeedRateRate; }
+        void SetLastOpcode(uint32 uiOpcode) { uiLastOpcode = uiOpcode; }
+        void ElaborateCheatReport(Player* pPlayer, uint8 uiReportType);
+        void SpeedHackDetection(MovementInfo& pOldPacket, MovementInfo& pNewPacket, uint32 uiOpcode, float fLastSpeedRate);
+        void FlyHackDetection(MovementInfo& pOldPacket, MovementInfo& pNewPacket);
+        void WalkOnWaterHackDetection(MovementInfo& pOldPacket, MovementInfo& pNewPacket);
+        bool CanFlyAnticheat(MovementInfo& pMovementInfo);
+        bool HasFirstReport();
+        void CleanTempCheatReports();
     protected:
         uint32 m_AreaID;
         uint32 m_regenTimerCount;
@@ -2625,6 +2641,13 @@
 
         bool isAlwaysDetectableFor(WorldObject const* seer) const;      
     private:
+        /*********************************************************/
+        /***                    ANTICHEAT SYSTEM               ***/
+        /*********************************************************/
+        float fLastSpeedRate;
+        uint32 uiLastOpcode;
+        MovementInfo lastMovementInfo;
+
         // internal common parts for CanStore/StoreItem functions
         uint8 _CanStoreItem_InSpecificSlot(uint8 bag, uint8 slot, ItemPosCountVec& dest, ItemPrototype const *pProto, uint32& count, bool swap, Item *pSrcItem) const;
         uint8 _CanStoreItem_InBag(uint8 bag, ItemPosCountVec& dest, ItemPrototype const *pProto, uint32& count, bool merge, bool non_specialized, Item *pSrcItem, uint8 skip_bag, uint8 skip_slot) const;
diff -r 62b7591c2cae src/server/game/Server/Protocol/Handlers/MovementHandler.cpp
--- a/src/server/game/Server/Protocol/Handlers/MovementHandler.cpp	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/game/Server/Protocol/Handlers/MovementHandler.cpp	Mon Nov 22 23:05:47 2010 -0300
@@ -340,6 +340,59 @@
     }
 
     /*----------------------*/
+    
+    // ANTICHEAT CHECKS
+    if (sWorld.getBoolConfig(CONFIG_ANTICHEAT_ENABLE))
+    {
+        /*********************/
+        /* Exceptions:
+            In Flight
+            On Transport
+            Being Teleported
+            Can't free move
+            Is GameMaster
+        **********************/
+
+        // preventing escape from JAIL! MUAHAHHAHA
+        if (plMover && plMover->GetAreaId() == 876 && !plMover->isGameMaster())
+        {
+            if (plMover->GetBaseMap()->GetAreaId(movementInfo.pos.GetPositionX(), movementInfo.pos.GetPositionY(), movementInfo.pos.GetPositionZ()) != 876)
+            {
+                plMover->TeleportTo(1,16226.5f,16403.6f,-64.5f,3.2f);
+                return;
+            }
+        }
+
+        if (plMover && !plMover->isInFlight() && !plMover->GetTransport() && !plMover->IsBeingTeleported() && plMover->CanFreeMove() && !plMover->isGameMaster())
+        {
+            // speed hack detection called!
+            plMover->SpeedHackDetection(plMover->GetLastPacket(), movementInfo,opcode, plMover->GetLastSpeedRate());
+
+            if (plMover->isAlive())
+                plMover->WalkOnWaterHackDetection(plMover->GetLastPacket(),movementInfo);
+                
+                // fly hack detection called!
+             plMover->FlyHackDetection(plMover->GetLastPacket(),movementInfo);
+        }
+
+        // save packet time for next control.
+        if (plMover)
+        {
+            uint8 uiMoveType = 0;
+
+            if (plMover->IsFlying())
+                uiMoveType = MOVE_FLIGHT;
+            else if (plMover->IsUnderWater())
+                uiMoveType = MOVE_SWIM;
+            else 
+                uiMoveType = MOVE_RUN;
+
+            plMover->SaveLastPacket(movementInfo);
+            plMover->SetLastSpeedRate(plMover->GetSpeedRate(UnitMoveType(uiMoveType)));//plMover->GetSpeed(UnitMoveType(uiMoveType)));//Rate(UnitMoveType(uiMoveType)));
+            plMover->SetLastOpcode(opcode);
+        }
+    }
+
 
     /* process position-change */
     WorldPacket data(opcode, recv_data.size());
diff -r 62b7591c2cae src/server/game/World/World.cpp
--- a/src/server/game/World/World.cpp	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/game/World/World.cpp	Mon Nov 22 23:05:47 2010 -0300
@@ -1181,6 +1181,13 @@
     // MySQL ping time interval
     m_int_configs[CONFIG_DB_PING_INTERVAL] = sConfig.GetIntDefault("MaxPingTime", 1800);
 
+    // anticheat configs
+    m_bool_configs[CONFIG_ANTICHEAT_ENABLE] = sConfig.GetBoolDefault("Anticheat.Enable", false);
+ 	m_int_configs[CONFIG_ANTICHEAT_MAX_DIFF_TIME] = sConfig.GetIntDefault("Anticheat.MaxDiffTime", 1000); // not used at the moment
+ 	m_int_configs[CONFIG_ANTICHEAT_MIN_DIFF_TIME] = sConfig.GetIntDefault("Anticheat.MinDiffTime", 50); // not used at the moment
+    m_int_configs[CONFIG_ANTICHEAT_REPORTS_FOR_GM_WARNING] = sConfig.GetIntDefault("Anticheat.ReportsForGMWarnings",75);
+    m_float_configs[CONFIG_ANTICHEAT_MAX_DISTANCE_DIFF_ALLOWED] = sConfig.GetFloatDefault("Anticheat.MaxMaxAllowedDistance",0.5f);
+
     sScriptMgr.OnConfigLoad(reload);
 }
 
@@ -2659,6 +2666,10 @@
         if (itr->second->GetPlayer())
             itr->second->GetPlayer()->ResetDailyQuestStatus();
 
+    //ANTICHEAT
+    CharacterDatabase.Execute("DELETE FROM cheat_reports;");
+    CharacterDatabase.Execute("DELETE FROM cheat_first_report;");
+
     // change available dailies
     sPoolMgr.ChangeDailyQuests();
 }
diff -r 62b7591c2cae src/server/game/World/World.h
--- a/src/server/game/World/World.h	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/game/World/World.h	Mon Nov 22 23:05:47 2010 -0300
@@ -162,6 +162,7 @@
     CONFIG_DUNGEON_FINDER_ENABLE,
     CONFIG_AUTOBROADCAST,
     CONFIG_ALLOW_TICKETS,
+    CONFIG_ANTICHEAT_ENABLE,
     BOOL_CONFIG_VALUE_COUNT
 };
 
@@ -178,6 +179,7 @@
     CONFIG_CREATURE_FAMILY_ASSISTANCE_RADIUS,
     CONFIG_THREAT_RADIUS,
     CONFIG_CHANCE_OF_GM_SURVEY,
+    CONFIG_ANTICHEAT_MAX_DISTANCE_DIFF_ALLOWED,
     FLOAT_CONFIG_VALUE_COUNT
 };
 
@@ -307,6 +309,9 @@
     CONFIG_AUTOBROADCAST_INTERVAL,
     CONFIG_MAX_RESULTS_LOOKUP_COMMANDS,
     CONFIG_DB_PING_INTERVAL,
+    CONFIG_ANTICHEAT_MAX_DIFF_TIME,
+ 	CONFIG_ANTICHEAT_MIN_DIFF_TIME,
+    CONFIG_ANTICHEAT_REPORTS_FOR_GM_WARNING,
     INT_CONFIG_VALUE_COUNT
 };
 
diff -r 62b7591c2cae src/server/scripts/Commands/cs_gm.cpp
--- a/src/server/scripts/Commands/cs_gm.cpp	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/scripts/Commands/cs_gm.cpp	Mon Nov 22 23:05:47 2010 -0300
@@ -256,7 +256,326 @@
     }
 };
 
+class anticheat_commandscript : public CommandScript
+{
+public:
+    anticheat_commandscript() : CommandScript("anticheat_commandscript") { }
+
+    ChatCommand* GetCommands() const
+    {
+        static ChatCommand anticheatCommandTable[] =
+        {
+            { "global",         SEC_GAMEMASTER,     true,  &HandleAntiCheatGlobalCommand,         "", NULL },
+            { "player",         SEC_GAMEMASTER,     true,  &HandleAntiCheatPlayerCommand,         "", NULL },
+            { "delete",         SEC_ADMINISTRATOR,  true,  &HandleAntiCheatDeleteCommand,         "", NULL },
+            { "handle",         SEC_ADMINISTRATOR,  true,  &HandleAntiCheatHandleCommand,         "", NULL },
+            { "jail",           SEC_GAMEMASTER,     true,  &HandleAnticheatJailCommand,         "", NULL },
+            { "warn",           SEC_GAMEMASTER,     true,  &HandleAnticheatWarnCommand,         "", NULL },
+            { NULL,             0,                     false, NULL,                                           "", NULL }
+        };
+
+        static ChatCommand commandTable[] =
+        {
+            { "anticheat",      SEC_GAMEMASTER,     true, NULL,                     "",  anticheatCommandTable},
+            { NULL,             0,                  false, NULL,                               "", NULL }
+        };
+
+        return commandTable;
+    }
+
+    static bool HandleAnticheatWarnCommand(ChatHandler* handler, const char* args)
+    {
+        Player* pTarget = NULL;
+        
+        std::string strCommand;
+
+        char* command = strtok((char*)args, " ");
+
+        if (command)
+        {
+            strCommand = command;
+            normalizePlayerName(strCommand);
+
+            pTarget = sObjectMgr.GetPlayer(strCommand.c_str()); //get player by name
+        }else 
+            pTarget = handler->getSelectedPlayer();
+
+        if (!pTarget)
+            return false;
+        
+        WorldPacket data;
+
+        // need copy to prevent corruption by strtok call in LineFromMessage original string
+        char* buf = strdup("The anticheat system has reported several times that you may be cheating. You will be monitored to confirm if this is accurate.");
+        char* pos = buf;
+
+        while (char* line = handler->LineFromMessage(pos))
+        {
+            handler->FillSystemMessageData(&data, line);
+            pTarget->GetSession()->SendPacket(&data);
+        }
+
+        free(buf);
+        return true;
+    }
+    static bool HandleAnticheatJailCommand(ChatHandler* handler, const char* args)
+    {
+        Player* pTarget = NULL;
+        
+        std::string strCommand;
+
+        char* command = strtok((char*)args, " ");
+
+        if (command)
+        {
+            strCommand = command;
+            normalizePlayerName(strCommand);
+
+            pTarget = sObjectMgr.GetPlayer(strCommand.c_str()); //get player by name
+        }else 
+            pTarget = handler->getSelectedPlayer();
+
+        if (!pTarget)
+        {
+            handler->SendSysMessage(LANG_PLAYER_NOT_FOUND);
+            handler->SetSentErrorMessage(true);
+            return false;
+        }
+
+        if (pTarget == handler->GetSession()->GetPlayer())
+            return false;
+    
+        // teleport both to jail.
+        pTarget->TeleportTo(1,16226.5f,16403.6f,-64.5f,3.2f);
+        handler->GetSession()->GetPlayer()->TeleportTo(1,16226.5f,16403.6f,-64.5f,3.2f);
+
+        WorldLocation loc;
+
+        // the player should be already there, but no :(
+        // pTarget->GetPosition(&loc);
+
+        loc.m_mapId = 1;
+        loc.m_positionX = 16226.5f;
+        loc.m_positionY = 16403.6f;
+        loc.m_positionZ = -64.5f;
+        loc.m_orientation = 3.2f;
+
+        pTarget->SetHomebind(loc,876);
+        return true;
+    }
+
+    static bool HandleAntiCheatDeleteCommand(ChatHandler* handler, const char* args)
+    {
+        std::string strCommand;
+
+        char* command = strtok((char*)args, " "); //get entered name
+
+        if (!command)
+            return true;
+        
+        strCommand = command;
+        
+        if (strCommand.compare("deleteall") == 0)
+        {
+            uint8 uiStmt[3] = {CHAR_ANTICHEAT_CLEAN_CHEAT_FIRST_REPORT,CHAR_ANTICHEAT_CLEAN_CHEATERS_TEMP, CHAR_ANTICHEAT_CLEAN_CHEATERS };
+            for (uint8 uiI = 0; uiI < 3; uiI++)
+            {
+                PreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(uiStmt[uiI]);
+                CharacterDatabase.Execute(stmt);
+            }
+
+        } else
+        {
+            normalizePlayerName(strCommand);
+            Player* pPlayer = sObjectMgr.GetPlayer(strCommand.c_str()); //get player by name
+
+            if (!pPlayer)
+                handler->PSendSysMessage("Player doesn't exist");
+            else
+            {
+                uint8 uiStmt[3] = {CHAR_ANTICHEAT_DEL_CHEATERS, CHAR_ANTICHEAT_DEL_CHEATERS_TEMP,CHAR_ANTICHEAT_DEL_CHEAT_FIRST_REPORT};
+
+                for (uint8 uiI = 0; uiI < 3; uiI++)
+                {
+                    PreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(uiStmt[uiI]);
+                    stmt->setUInt64(0, pPlayer->GetGUIDLow());
+                    CharacterDatabase.Execute(stmt);
+                }
+            }
+        }
+
+        return true;
+    }
+
+    static bool HandleAntiCheatPlayerCommand(ChatHandler* handler, const char* args)
+    {
+        std::string strCommand;
+
+        char* command = strtok((char*)args, " ");
+
+        uint32 uiGUID = 0;
+        Player* pPlayer = NULL;
+        
+        if (command)
+        {
+            strCommand = command;
+
+            normalizePlayerName(strCommand);
+
+            pPlayer = sObjectMgr.GetPlayer(strCommand.c_str()); //get player by name
+
+            if (pPlayer)
+                uiGUID = pPlayer->GetGUIDLow();
+        }else 
+        {
+            pPlayer = handler->getSelectedPlayer();
+            if (pPlayer)
+                uiGUID = pPlayer->GetGUIDLow();  
+        }
+
+        if (uiGUID == 0)
+        {
+            handler->PSendSysMessage("There is no player.");
+            return true;
+        }
+        
+        PreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_GET_CHEATERS_BY_GUID);
+        stmt->setUInt32(0,uiGUID);
+        PreparedQueryResult result = CharacterDatabase.Query(stmt);
+
+        if (result)
+        {
+            do
+            {
+                Field* fields=result->Fetch();
+                uint32 warnings = fields[0].GetUInt32();
+                handler->PSendSysMessage("Amount: %u", warnings);
+            }
+            while (result->NextRow());
+        } else
+            handler->PSendSysMessage("Player's amount log is empty!.");
+
+        stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_GET_CHEATERS_AVERAGE_BY_GUID);
+        stmt->setUInt32(0,uiGUID);
+        result = CharacterDatabase.Query(stmt);
+
+        if (result)
+        {
+            do
+            {
+                Field* fields=result->Fetch();
+                uint32 average = fields[0].GetUInt32();
+                uint32 warnings = fields[1].GetUInt32();
+
+                handler->PSendSysMessage("Average: %u Warnings: %u", average, warnings);
+            }
+            while (result->NextRow());
+        } else
+            handler->PSendSysMessage("Player's average log is empty!.");
+
+
+        stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_GET_REPORTS_TYPE_BY_GUID);
+        stmt->setUInt32(0,uiGUID);
+        result = CharacterDatabase.Query(stmt);
+        
+        uint32 uiReportsAmount[3] = {0,0,0};
+
+        if (result)
+        {
+            do
+            {
+                Field* fields=result->Fetch();
+                std::string report = fields[0].GetString();
+                
+                if (report.compare("Speed-Hack") == 0)
+                    uiReportsAmount[0]++;
+                else if (report.compare("Fly-Hack") == 0)
+                    uiReportsAmount[1]++;
+                else if (report.compare("WalkOnWater-Hack") == 0)
+                    uiReportsAmount[2]++;
+            }
+            while (result->NextRow());
+        }
+
+        handler->PSendSysMessage("Speed-Hack reports: %u || Fly-Hack reports: %u ||  WalkOnWater-Hack reports: %u", uiReportsAmount[0],uiReportsAmount[1],uiReportsAmount[2]);
+
+        return true;
+    }
+
+    static bool HandleAntiCheatHandleCommand(ChatHandler* handler, const char* args)
+    {
+        std::string strCommand;
+
+        char* command = strtok((char*)args, " ");
+        
+        if (!command)
+            return true;
+
+        if (!handler->GetSession()->GetPlayer())
+            return true;
+
+        strCommand = command;
+
+        if (strCommand.compare("on") == 0)
+        {
+            sWorld.setBoolConfig(CONFIG_ANTICHEAT_ENABLE,true);
+            handler->SendSysMessage("The AntiCheat-System is now: Enabled!");
+        }
+        else if (strCommand.compare("off") == 0)
+        {
+            sWorld.setBoolConfig(CONFIG_ANTICHEAT_ENABLE,false);
+            handler->SendSysMessage("The AntiCheat-System is now: Disabled!");
+        }
+
+        return true;
+    }
+
+    static bool HandleAntiCheatGlobalCommand(ChatHandler* handler, const char* args)
+    {
+        PreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_GET_CHEATERS);
+        PreparedQueryResult result = CharacterDatabase.Query(stmt);
+
+        handler->PSendSysMessage("Cheaters by Amount: -------------");
+        if (result)
+        {
+            do
+            {
+                Field* fields=result->Fetch();
+                std::string name = fields[0].GetCString();
+                uint32 warnings = fields[1].GetUInt32();
+
+                handler->PSendSysMessage("Name: %s Warnings: %u", name.c_str(), warnings);
+            }
+            while (result->NextRow());
+        } else
+            handler->PSendSysMessage("Cheaters amount log empty!.");
+
+        handler->PSendSysMessage("Cheaters by Average: -------------");
+
+        stmt = CharacterDatabase.GetPreparedStatement(CHAR_ANTICHEAT_GET_CHEATERS_AVERAGE);
+        result = CharacterDatabase.Query(stmt);
+
+        if (result)
+        {
+            do
+            {
+                Field* fields=result->Fetch();
+                std::string name = fields[0].GetCString();
+                uint32 average = fields[1].GetUInt32();
+                uint32 warnings = fields[2].GetUInt32();
+
+                handler->PSendSysMessage("Name: %s  Average: %u Warnings: %u", name.c_str(), average, warnings);
+            }
+            while (result->NextRow());
+        } else
+            handler->PSendSysMessage("Cheaters average log empty!.");
+
+        return true;
+    }
+};
+
 void AddSC_gm_commandscript()
 {
     new gm_commandscript();
+    new anticheat_commandscript();
 }
diff -r 62b7591c2cae src/server/shared/Database/Implementation/CharacterDatabase.cpp
--- a/src/server/shared/Database/Implementation/CharacterDatabase.cpp	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/shared/Database/Implementation/CharacterDatabase.cpp	Mon Nov 22 23:05:47 2010 -0300
@@ -215,5 +215,21 @@
     PrepareStatement(CHAR_DEL_CRESPAWNTIME, "DELETE FROM creature_respawn WHERE guid = ? AND instance = ?");
     PrepareStatement(CHAR_ADD_CRESPAWNTIME, "INSERT INTO creature_respawn VALUES (?, ?, ?)");
 
+    PrepareStatement(CHAR_ANTICHEAT_SET_CHEATERS, "INSERT INTO cheat_reports (`guid`,`name`,`mapid`,`position_x`,`position_y`,`position_z`,`report`,`time`) VALUES (?,?,?,?,?,?,?,?);");
+    PrepareStatement(CHAR_ANTICHEAT_SET_CHEATERS_TEMP, "INSERT INTO cheat_temp_reports (`guid`,`name`,`mapid`,`position_x`,`position_y`,`position_z`,`report`,`time`) VALUES (?,?,?,?,?,?,?,?);");
+    PrepareStatement(CHAR_ANTICHEAT_GET_CHEATERS, "SELECT A.`name` , count( * ) AS 'Repeticiones' FROM `characters` AS A, `cheat_reports` AS B WHERE A.`online` =1 AND A.`guid` = B.`guid` GROUP BY B.`guid` ORDER BY Repeticiones DESC LIMIT 0 , 3");
+    PrepareStatement(CHAR_ANTICHEAT_SET_CHEAT_FIRST_REPORT, "INSERT INTO cheat_first_report (`guid`,`name`,`time`) VALUES (?,?,?);");
+    PrepareStatement(CHAR_ANTICHEAT_GET_CHEATERS_AVERAGE, "SELECT A.`name` , CAST((SUM(B.time ) / count( * ) ) - C.time AS UNSIGNED) AS 'promedio' , CAST(count( * ) AS UNSIGNED) AS 'Repeticiones' FROM `characters` AS A, `cheat_temp_reports` AS B, cheat_first_report AS C WHERE A.`online` =1 AND A.`guid` = B.`guid` AND A.guid = C.guid GROUP BY B.`guid` ORDER BY Repeticiones  DESC LIMIT 0 , 3;");
+    PrepareStatement(CHAR_ANTICHEAT_GET_CHEAT_FIRST_REPORT, "SELECT * FROM cheat_first_report WHERE guid=?;");
+    PrepareStatement(CHAR_ANTICHEAT_DEL_CHEAT_FIRST_REPORT, "DELETE FROM cheat_first_report WHERE guid=?");
+    PrepareStatement(CHAR_ANTICHEAT_DEL_CHEATERS_TEMP, "DELETE FROM cheat_temp_reports WHERE guid=?");
+    PrepareStatement(CHAR_ANTICHEAT_DEL_CHEATERS, "DELETE FROM cheat_reports WHERE guid=?");
+    PrepareStatement(CHAR_ANTICHEAT_CLEAN_CHEAT_FIRST_REPORT, "DELETE FROM cheat_first_report;");
+    PrepareStatement(CHAR_ANTICHEAT_CLEAN_CHEATERS_TEMP, "DELETE FROM cheat_temp_reports");
+    PrepareStatement(CHAR_ANTICHEAT_CLEAN_CHEATERS, "DELETE FROM cheat_reports;");
+
+    PrepareStatement(CHAR_ANTICHEAT_GET_CHEATERS_AVERAGE_BY_GUID,"SELECT CAST((SUM(B.time ) / count( * ) ) - C.time AS UNSIGNED) AS 'promedio' , CAST(count( * ) AS UNSIGNED) AS 'Repeticiones' FROM `characters` AS A, `cheat_temp_reports` AS B, cheat_first_report AS C WHERE A.`online` =1 AND A.`guid` = B.`guid` AND A.guid = C.guid AND A.`guid`=? GROUP BY B.`guid` ORDER BY Repeticiones  DESC LIMIT 0 , 1;");
+    PrepareStatement(CHAR_ANTICHEAT_GET_CHEATERS_BY_GUID,"SELECT count( * ) AS 'Repeticiones' FROM `characters` AS A, `cheat_reports` AS B WHERE A.`online` =1 AND A.`guid` = B.`guid` AND A.`guid`=? GROUP BY B.`guid` ORDER BY Repeticiones DESC LIMIT 0 , 1");
+    PrepareStatement(CHAR_ANTICHEAT_GET_REPORTS_TYPE_BY_GUID,"SELECT report FROM cheat_reports WHERE guid=?;");
     return true;
 }
diff -r 62b7591c2cae src/server/shared/Database/Implementation/CharacterDatabase.h
--- a/src/server/shared/Database/Implementation/CharacterDatabase.h	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/shared/Database/Implementation/CharacterDatabase.h	Mon Nov 22 23:05:47 2010 -0300
@@ -180,6 +180,24 @@
     CHAR_DEL_GAMEOBJECT_RESPAWN_TIMES,
     CHAR_DEL_CRESPAWNTIME,
     CHAR_ADD_CRESPAWNTIME,
+    
+    CHAR_ANTICHEAT_SET_CHEATERS,
+    CHAR_ANTICHEAT_GET_CHEATERS,
+    CHAR_ANTICHEAT_SET_CHEAT_FIRST_REPORT,
+    CHAR_ANTICHEAT_GET_CHEAT_FIRST_REPORT,
+    CHAR_ANTICHEAT_GET_CHEATERS_AVERAGE,
+    CHAR_ANTICHEAT_DEL_CHEAT_FIRST_REPORT,
+    CHAR_ANTICHEAT_SET_CHEATERS_TEMP,
+    CHAR_ANTICHEAT_DEL_CHEATERS_TEMP,
+    CHAR_ANTICHEAT_DEL_CHEATERS,
+
+    CHAR_ANTICHEAT_CLEAN_CHEAT_FIRST_REPORT,
+    CHAR_ANTICHEAT_CLEAN_CHEATERS_TEMP,
+    CHAR_ANTICHEAT_CLEAN_CHEATERS,
+
+    CHAR_ANTICHEAT_GET_CHEATERS_AVERAGE_BY_GUID,
+    CHAR_ANTICHEAT_GET_CHEATERS_BY_GUID,
+    CHAR_ANTICHEAT_GET_REPORTS_TYPE_BY_GUID,
 
     MAX_CHARACTERDATABASE_STATEMENTS,
 };
diff -r 62b7591c2cae src/server/worldserver/worldserver.conf.dist
--- a/src/server/worldserver/worldserver.conf.dist	Mon Nov 22 18:36:08 2010 +0100
+++ b/src/server/worldserver/worldserver.conf.dist	Mon Nov 22 23:05:47 2010 -0300
@@ -2049,6 +2049,19 @@
 #        Default: 0 - off
 #                 1 - on
 #
+#   Anticheat.Enable
+#        Enable Anticheat System
+#        Default: 0 - off
+#                 1 - on
+#   Anticheat.MaxDiffTime
+#        Default: 1000 ms
+#   Anticheat.MinDiffTime
+#        Default: 350 ms
+#   Anticheat.MaxMaxAllowedDistance
+#	    Default: 0.5 f
+#   Anticheat.ReportsForGMWarnings
+#	    Enable and set warnings (at which amount will allow the report) for ingame-report, -1 disables it
+#	    Default: 75
 ###############################################################################
 
 PlayerStart.AllReputation = 0
@@ -2072,3 +2085,8 @@
 LevelReq.Auction = 1
 LevelReq.Mail = 1
 DungeonFinder.Enable = 0
+Anticheat.Enable = 0
+Anticheat.MaxDiffTime = 1000
+Anticheat.MinDiffTime = 50
+Anticheat.MaxMaxAllowedDistance = 0.5
+Anticheat.ReportsForGMWarnings = 75
\ No newline at end of file
